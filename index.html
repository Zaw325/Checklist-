<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mrs. Sparkle - Chemical Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide-react@0.395.0/dist/umd/lucide.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-blue': '#2563eb',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Base Styles */
        body { font-family: system-ui, -apple-system, sans-serif; }

        /* Print Styles - Forces Table Layout on Paper */
        @media print {
            @page { size: A4; margin: 1cm; }
            body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; background: white; }
            .no-print { display: none !important; }
            
            /* Hide Mobile Elements */
            .mobile-label { display: none !important; }
            
            /* Force Desktop Grid Layout */
            .responsive-row {
                display: grid !important;
                grid-template-columns: repeat(12, minmax(0, 1fr)) !important;
                gap: 0.5rem !important;
                border: none !important;
                padding: 0.5rem 0 !important;
                box-shadow: none !important;
                page-break-inside: avoid;
            }
            
            /* Headers */
            .table-header { display: grid !important; background-color: #2563eb !important; color: white !important; }
            
            /* Input cleanup for print */
            input { border: none !important; background: transparent !important; padding: 0 !important; }
            .print-border { border-bottom: 1px solid #ddd !important; }
        }

        /* Animation for Login Shake */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen pb-20">

    <div id="login-overlay" class="fixed inset-0 bg-slate-900 flex items-center justify-center z-50 transition-opacity duration-300 px-4">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-sm text-center">
            <div class="mb-4 bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto text-blue-600">
                <i data-lucide="lock" class="w-8 h-8"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Mrs. Sparkle</h3>
            <p class="text-gray-500 mb-6 text-sm">Chemical Inventory System</p>
            
            <input type="password" id="password-input" placeholder="Enter Password" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue text-center text-lg mb-4">
            
            <button id="unlock-button" class="w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition-all shadow-lg shadow-blue-200">
                Access Checklist
            </button>
            <p id="error-msg" class="text-red-500 text-sm mt-3 hidden font-medium"></p>
        </div>
    </div>

    <div id="app-container" class="max-w-4xl mx-auto p-3 md:p-6 hidden opacity-0 transition-opacity duration-500">
        
        <div class="bg-white rounded-xl shadow-sm p-6 mb-4 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-brand-blue"></div>
            <h1 class="text-xl font-bold text-gray-800">Mrs. Sparkle</h1>
            <h2 class="text-lg text-brand-blue font-medium">Chemical Checklist</h2>
            <p id="current-date" class="text-xs text-gray-400 mt-2 uppercase tracking-wider font-semibold"></p>
        </div>
        
        <div class="bg-white rounded-xl shadow-sm overflow-hidden">
            
            <div class="table-header hidden md:grid grid-cols-12 gap-4 bg-gray-50 p-4 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-100">
                <div class="col-span-4">Items</div>
                <div class="col-span-2 text-center">Current</div>
                <div class="col-span-2 text-center">Needed</div>
                <div class="col-span-3">Remark</div>
                <div class="col-span-1 text-center">Action</div>
            </div>

            <div id="checklist-body" class="p-3 md:p-0 bg-gray-50 md:bg-white">
                </div>
        </div>

        <div class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 p-3 shadow-lg z-40 no-print">
            <div class="max-w-4xl mx-auto flex gap-2 justify-between">
                <div class="flex gap-2 w-full">
                    <button id="add-row-btn" class="flex-1 bg-gray-800 text-white py-3 rounded-lg font-semibold flex items-center justify-center gap-2 hover:bg-gray-700">
                        <i data-lucide="plus" class="w-5 h-5"></i> <span class="hidden sm:inline">Add Item</span>
                    </button>
                    
                    <button id="load-template-btn" class="flex-none bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300" title="Load Template">
                        <i data-lucide="list-restart" class="w-5 h-5"></i>
                    </button>

                    <div class="w-px bg-gray-300 mx-1"></div>

                    <button id="print-btn" class="flex-none bg-blue-100 text-blue-700 py-3 px-4 rounded-lg font-semibold hover:bg-blue-200" title="Print">
                        <i data-lucide="printer" class="w-5 h-5"></i>
                    </button>
                    
                    <button id="clear-all-btn" class="flex-none bg-red-100 text-red-600 py-3 px-4 rounded-lg font-semibold hover:bg-red-200" title="Clear All">
                        <i data-lucide="trash-2" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="h-20"></div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const CONFIG = {
            password: 'joeclean',
            storageKey: 'sparkle_chem_v2'
        };

        // --- TEMPLATE DATA ---
        const defaultTemplate = [
            { id: 1, item: 'Ma Ma Lemon', current: '', needed: '', remark: '' },
            { id: 2, item: 'Pine', current: '', needed: '', remark: '' },
            { id: 3, item: 'Bleach', current: '', needed: '', remark: '' },
            { id: 4, item: '202', current: '', needed: '', remark: '' },
            { id: 5, item: '506', current: '', needed: '', remark: '' },
            { id: 6, item: 'No.7', current: '', needed: '', remark: '' },
            { id: 7, item: 'Sticker Remover', current: '', needed: '', remark: '' },
            { id: 8, item: '703 (Steel Polish)', current: '', needed: '', remark: '' },
        ];

        // --- APP LOGIC ---
        const App = {
            data: [],

            init() {
                this.bindLogin();
                // Lucide icons will be refreshed after render
            },

            bindLogin() {
                const btn = document.getElementById('unlock-button');
                const input = document.getElementById('password-input');
                
                const tryLogin = () => {
                    if (input.value === CONFIG.password) {
                        document.getElementById('login-overlay').style.display = 'none';
                        const app = document.getElementById('app-container');
                        app.classList.remove('hidden');
                        setTimeout(() => app.classList.remove('opacity-0'), 50);
                        this.startSystem();
                    } else {
                        const err = document.getElementById('error-msg');
                        err.textContent = "Wrong password!";
                        err.classList.remove('hidden');
                        input.value = '';
                        input.parentElement.classList.add('animate-shake');
                        setTimeout(() => input.parentElement.classList.remove('animate-shake'), 500);
                    }
                };

                btn.onclick = tryLogin;
                input.addEventListener('keyup', (e) => { if (e.key === 'Enter') tryLogin(); });
            },

            startSystem() {
                // Set Date
                document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-SG', {
                    weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
                });

                // Load Data
                const saved = localStorage.getItem(CONFIG.storageKey);
                if (saved) {
                    this.data = JSON.parse(saved);
                } else {
                    this.data = JSON.parse(JSON.stringify(defaultTemplate));
                }

                this.render();
                this.bindActions();
            },

            bindActions() {
                document.getElementById('add-row-btn').onclick = () => {
                    this.data.push({ id: Date.now(), item: '', current: '', needed: '', remark: '' });
                    this.saveAndRender();
                };

                document.getElementById('load-template-btn').onclick = () => {
                    if(confirm('Reset to default template? Current data will be lost.')) {
                        this.data = JSON.parse(JSON.stringify(defaultTemplate));
                        // Give new IDs to prevent conflict if we had logic relying on it
                        this.data.forEach(d => d.id = Date.now() + Math.random());
                        this.saveAndRender();
                    }
                };

                document.getElementById('clear-all-btn').onclick = () => {
                    if(confirm('Delete ALL items?')) {
                        this.data = [];
                        this.saveAndRender();
                    }
                };

                document.getElementById('print-btn').onclick = () => window.print();

                // Event Delegation for dynamic inputs
                const listBody = document.getElementById('checklist-body');
                
                listBody.addEventListener('input', (e) => {
                    if(e.target.dataset.field) {
                        const id = parseFloat(e.target.closest('.responsive-row').dataset.id);
                        const field = e.target.dataset.field;
                        const row = this.data.find(r => r.id === id);
                        if(row) {
                            row[field] = e.target.value;
                            this.save(); // Save silently
                        }
                    }
                });

                listBody.addEventListener('click', (e) => {
                    if(e.target.closest('.delete-btn')) {
                        const rowEl = e.target.closest('.responsive-row');
                        const id = parseFloat(rowEl.dataset.id);
                        // Add a fade out effect
                        rowEl.style.opacity = '0';
                        setTimeout(() => {
                            this.data = this.data.filter(r => r.id !== id);
                            this.saveAndRender();
                        }, 200);
                    }
                });
            },

            save() {
                localStorage.setItem(CONFIG.storageKey, JSON.stringify(this.data));
            },

            saveAndRender() {
                this.save();
                this.render();
            },

            render() {
                const container = document.getElementById('checklist-body');
                container.innerHTML = '';

                if (this.data.length === 0) {
                    container.innerHTML = `<div class="text-center py-10 text-gray-400">List is empty.<br>Tap "Add Item" to start.</div>`;
                    return;
                }

                this.data.forEach(row => {
                    const div = document.createElement('div');
                    
                    // --- RESPONSIVE CLASSES ---
                    // Mobile: Card style (white bg, shadow, rounded)
                    // Desktop: Grid style (flat, border-bottom)
                    div.className = `responsive-row relative bg-white p-4 mb-3 rounded-xl shadow-sm border border-gray-200 
                                     md:mb-0 md:shadow-none md:rounded-none md:border-0 md:border-b md:border-gray-100 
                                     md:grid md:grid-cols-12 md:gap-4 md:items-center md:py-3 transition-all duration-200`;
                    
                    div.dataset.id = row.id;

                    div.innerHTML = `
                        <div class="md:col-span-4 mb-3 md:mb-0">
                            <label class="text-xs font-bold text-gray-400 uppercase block md:hidden mb-1 mobile-label">Item Name</label>
                            <input type="text" value="${row.item}" data-field="item" 
                                class="w-full font-semibold text-gray-800 bg-transparent border-b border-gray-200 focus:border-blue-500 focus:outline-none pb-1 md:border-gray-300 md:border rounded md:px-2 md:py-1.5 md:text-sm" 
                                placeholder="Type Item...">
                        </div>

                        <div class="flex gap-3 mb-3 md:mb-0 md:contents">
                            <div class="flex-1 md:col-span-2">
                                <label class="text-xs font-bold text-gray-400 uppercase block md:hidden mb-1 mobile-label">Current</label>
                                <input type="tel" value="${row.current}" data-field="current" 
                                    class="w-full text-center bg-gray-50 border border-gray-200 rounded-lg py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none md:bg-white md:py-1.5 md:text-sm" 
                                    placeholder="0">
                            </div>
                            <div class="flex-1 md:col-span-2">
                                <label class="text-xs font-bold text-blue-500 uppercase block md:hidden mb-1 mobile-label">Need</label>
                                <input type="tel" value="${row.needed}" data-field="needed" 
                                    class="w-full text-center font-bold text-blue-600 bg-blue-50 border border-blue-100 rounded-lg py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none md:bg-white md:text-gray-800 md:border-gray-300 md:py-1.5 md:text-sm" 
                                    placeholder="0">
                            </div>
                        </div>

                        <div class="md:col-span-3 mb-2 md:mb-0">
                             <label class="text-xs font-bold text-gray-400 uppercase block md:hidden mb-1 mobile-label">Remark</label>
                            <input type="text" value="${row.remark}" data-field="remark" 
                                class="w-full text-sm text-gray-600 bg-transparent border-b border-dashed border-gray-300 focus:border-blue-500 focus:outline-none pb-1 md:border-solid md:border md:rounded md:px-2 md:py-1.5" 
                                placeholder="Add note...">
                        </div>

                        <div class="absolute top-2 right-2 md:relative md:top-auto md:right-auto md:col-span-1 md:text-center no-print">
                            <button class="delete-btn text-gray-400 hover:text-red-500 hover:bg-red-50 p-2 rounded-full transition-colors">
                                <i data-lucide="trash-2" class="w-5 h-5 md:w-4 md:h-4"></i>
                            </button>
                        </div>
                    `;
                    container.appendChild(div);
                });

                // Refresh Icons
                lucide.createIcons();
            }
        };

        // Start the app
        App.init();
    </script>
</body>
</html>
