<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mrs. Sparkle - Chemical Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-blue': '#2563eb',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Base Styles */
        body { font-family: system-ui, -apple-system, sans-serif; }

        /* Safe Area for Mobile Bottom */
        .safe-area-pb {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }

        /* Print Styles */
        @media print {
            @page { size: A4; margin: 1cm; }
            body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; background: white; }
            .no-print { display: none !important; }
            .mobile-label { display: none !important; }
            .responsive-row {
                display: grid !important;
                grid-template-columns: repeat(12, minmax(0, 1fr)) !important;
                gap: 0.5rem !important;
                border: none !important;
                padding: 0.5rem 0 !important;
                page-break-inside: avoid;
            }
            .table-header { display: grid !important; background-color: #2563eb !important; color: white !important; }
            input { border: none !important; background: transparent !important; padding: 0 !important; }
        }

        /* Toast Animation */
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .toast-enter { animation: slideUp 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen pb-40"> 

    <div id="login-overlay" class="fixed inset-0 bg-slate-900 flex items-center justify-center z-[60] px-4">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-sm text-center">
            <div class="mb-4 bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto text-blue-600 text-2xl">
                üîí
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Mrs. Sparkle</h3>
            <input type="password" id="password-input" placeholder="Enter Password" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-blue text-center text-lg mb-4">
            <button id="unlock-button" class="w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition-all">
                Login
            </button>
            <p id="error-msg" class="text-red-500 text-sm mt-3 hidden font-medium"></p>
        </div>
    </div>

    <div id="app-container" class="max-w-4xl mx-auto p-3 md:p-6 hidden opacity-0 transition-opacity duration-500">
        
        <div class="bg-white rounded-xl shadow-sm p-4 md:p-6 mb-4 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-brand-blue"></div>
            <h1 class="text-xl font-bold text-gray-800">Mrs. Sparkle</h1>
            <p id="current-date" class="text-xs text-gray-400 mt-1 uppercase tracking-wider font-semibold"></p>
        </div>
        
        <div class="hidden md:grid grid-cols-12 gap-4 bg-gray-200 p-3 rounded-t-lg text-xs font-bold text-gray-600 uppercase">
            <div class="col-span-4">Items</div>
            <div class="col-span-2 text-center">Current</div>
            <div class="col-span-2 text-center">Needed</div>
            <div class="col-span-3">Remark</div>
            <div class="col-span-1 text-center">Del</div>
        </div>

        <div id="checklist-body" class="space-y-3 md:space-y-0 md:bg-white md:shadow-sm md:rounded-b-lg">
            </div>
    </div>

    <div class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-50 no-print safe-area-pb">
        <div class="max-w-4xl mx-auto px-2 py-3 flex gap-2 items-center justify-between overflow-x-auto">
            
            <button id="add-row-btn" class="flex-grow bg-gray-800 text-white py-3 px-4 rounded-lg font-bold shadow active:scale-95 transition-transform whitespace-nowrap">
                + Add Item
            </button>

            <button id="save-btn" class="bg-green-600 text-white py-3 px-4 rounded-lg font-bold shadow active:scale-95 transition-transform whitespace-nowrap">
                üíæ Save
            </button>

            <button id="print-btn" class="bg-blue-600 text-white py-3 px-4 rounded-lg font-bold shadow active:scale-95 transition-transform whitespace-nowrap">
                üñ®Ô∏è Print
            </button>

            <button id="clear-all-btn" class="bg-red-100 text-red-600 py-3 px-4 rounded-lg font-bold shadow-sm border border-red-200 active:scale-95 transition-transform whitespace-nowrap">
                üóëÔ∏è Clear
            </button>
        </div>
    </div>

    <div id="toast" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-full shadow-xl z-[70] hidden flex items-center gap-2">
        <span class="text-green-400 text-xl">‚úì</span>
        <span class="font-semibold">Saved Successfully!</span>
    </div>

    <script>
        const CONFIG = { password: 'joeclean', storageKey: 'sparkle_chem_v5' };

        const App = {
            data: [],
            
            init() {
                this.setupLogin();
            },

            setupLogin() {
                const btn = document.getElementById('unlock-button');
                const input = document.getElementById('password-input');
                const attempt = () => {
                    if(input.value === CONFIG.password) {
                        document.getElementById('login-overlay').style.display = 'none';
                        const app = document.getElementById('app-container');
                        app.classList.remove('hidden');
                        setTimeout(() => app.classList.remove('opacity-0'), 50);
                        this.loadSystem();
                    } else {
                        document.getElementById('error-msg').textContent = "Wrong Password!";
                        document.getElementById('error-msg').classList.remove('hidden');
                    }
                };
                btn.onclick = attempt;
                input.onkeyup = (e) => { if(e.key === 'Enter') attempt(); };
            },

            loadSystem() {
                document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-SG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                
                const saved = localStorage.getItem(CONFIG.storageKey);
                this.data = saved ? JSON.parse(saved) : this.getDefaultTemplate();
                
                this.render();
                this.setupButtons();
            },

            getDefaultTemplate() {
                return [
                    { id: 1, item: 'Ma Ma Lemon', current: '', needed: '', remark: '' },
                    { id: 2, item: 'Pine', current: '', needed: '', remark: '' },
                    { id: 3, item: 'Bleach', current: '', needed: '', remark: '' },
                    { id: 4, item: '202', current: '', needed: '', remark: '' },
                    { id: 5, item: '506', current: '', needed: '', remark: '' },
                    { id: 6, item: 'No.7', current: '', needed: '', remark: '' },
                    { id: 7, item: 'Sticker Remover', current: '', needed: '', remark: '' },
                    { id: 8, item: '703 (Steel Polish)', current: '', needed: '', remark: '' },
                ];
            },

            setupButtons() {
                // Add Row
                document.getElementById('add-row-btn').onclick = () => {
                    this.data.push({ id: Date.now(), item: '', current: '', needed: '', remark: '' });
                    this.render();
                    this.save(false);
                    window.scrollTo(0, document.body.scrollHeight);
                };

                // Save Manual
                document.getElementById('save-btn').onclick = () => {
                    this.save(true);
                };

                // Print
                document.getElementById('print-btn').onclick = () => window.print();

                // Clear All
                document.getElementById('clear-all-btn').onclick = () => {
                    if(confirm('Are you sure you want to delete everything?')) {
                        this.data = [];
                        this.render();
                        this.save(false);
                    }
                };

                // Input delegation
                document.getElementById('checklist-body').addEventListener('input', (e) => {
                    if(e.target.dataset.field) {
                        const id = parseFloat(e.target.closest('.row-item').dataset.id);
                        const row = this.data.find(r => r.id === id);
                        if(row) row[e.target.dataset.field] = e.target.value;
                        localStorage.setItem(CONFIG.storageKey, JSON.stringify(this.data));
                    }
                });

                // Delete single row
                document.getElementById('checklist-body').addEventListener('click', (e) => {
                    if(e.target.closest('.delete-btn')) {
                        const rowEl = e.target.closest('.row-item');
                        const id = parseFloat(rowEl.dataset.id);
                        if(confirm('Delete this item?')) {
                            this.data = this.data.filter(r => r.id !== id);
                            this.render();
                            this.save(false);
                        }
                    }
                });
            },

            save(showToast = true) {
                localStorage.setItem(CONFIG.storageKey, JSON.stringify(this.data));
                if(showToast) {
                    const toast = document.getElementById('toast');
                    toast.classList.remove('hidden', 'toast-enter');
                    void toast.offsetWidth; // trigger reflow
                    toast.classList.add('toast-enter');
                    toast.classList.remove('hidden');
                    setTimeout(() => toast.classList.add('hidden'), 2000);
                }
            },

            render() {
                const container = document.getElementById('checklist-body');
                container.innerHTML = '';

                if(this.data.length === 0) {
                    container.innerHTML = `<div class="text-center py-10 text-gray-400">List is empty. Tap "Add New" to start.</div>`;
                    return;
                }

                this.data.forEach(row => {
                    const div = document.createElement('div');
                    div.className = 'row-item relative bg-white p-4 rounded-xl shadow-sm border border-gray-200 md:grid md:grid-cols-12 md:gap-4 md:items-center md:p-2 md:rounded-none md:border-0 md:border-b md:shadow-none responsive-row';
                    div.dataset.id = row.id;

                    div.innerHTML = `
                        <div class="md:col-span-4 mb-3 md:mb-0">
                            <label class="mobile-label text-[10px] font-bold text-gray-400 uppercase block md:hidden mb-1">Item Name</label>
                            <input type="text" value="${row.item}" data-field="item" class="w-full font-bold text-gray-800 border-b border-gray-200 pb-1 focus:outline-none focus:border-blue-500 md:border md:rounded md:px-2 md:py-1 md:text-sm" placeholder="Item name...">
                        </div>

                        <div class="flex gap-3 mb-3 md:mb-0 md:contents">
                            <div class="flex-1 md:col-span-2">
                                <label class="mobile-label text-[10px] font-bold text-gray-400 uppercase block md:hidden mb-1">Current</label>
                                <input type="text" value="${row.current}" data-field="current" class="w-full text-center bg-gray-50 border border-gray-200 rounded-lg py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 md:bg-white md:py-1 md:text-sm" placeholder="0">
                            </div>
                            <div class="flex-1 md:col-span-2">
                                <label class="mobile-label text-[10px] font-bold text-blue-500 uppercase block md:hidden mb-1">Need</label>
                                <input type="text" value="${row.needed}" data-field="needed" class="w-full text-center font-bold text-blue-600 bg-blue-50 border border-blue-100 rounded-lg py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 md:bg-white md:text-gray-800 md:border-gray-200 md:py-1 md:text-sm" placeholder="0">
                            </div>
                        </div>

                        <div class="md:col-span-3 mb-1 md:mb-0">
                            <label class="mobile-label text-[10px] font-bold text-gray-400 uppercase block md:hidden mb-1">Remark</label>
                            <input type="text" value="${row.remark}" data-field="remark" class="w-full text-sm text-gray-600 border-b border-dashed border-gray-300 pb-1 focus:outline-none focus:border-blue-500 md:border-solid md:border md:rounded md:px-2 md:py-1" placeholder="Note...">
                        </div>

                        <div class="absolute top-4 right-4 md:relative md:top-auto md:right-auto md:col-span-1 md:text-center no-print">
                            <button class="delete-btn text-gray-300 hover:text-red-500 p-1 text-xl">
                                ‚úï
                            </button>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }
        };

        App.init();
    </script>
</body>
</html>
